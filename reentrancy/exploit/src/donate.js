const Web3 = require('web3');
const HDWalletProvider = require("@truffle/hdwallet-provider");
const walletArtifact = require('../../build/contracts/Wallet.json');

require('dotenv').config();

let provider = new HDWalletProvider(process.env.METAMASK_SEED, `https://rinkeby.infura.io/v3/${process.env.INFURA_KEY}`);
let web3 = new Web3(provider);


const WALLET1_ADDR = "0x03b83225C3acD0a7F2D21495d6abAc46d227B0aF";
const WALLET2_ADDR = "0x73Cbd147279B68b32AE5eFA879bc522eCFe156f2";
const wallet1Instance = new web3.eth.Contract(walletArtifact.abi, WALLET1_ADDR);
const wallet2Instance = new web3.eth.Contract(walletArtifact.abi, WALLET2_ADDR);

// 1 Gwei
const donation = web3.utils.toWei('0.000000001', 'ether');

(async () => {
    await wallet1Instance.methods.donate(donation).send({from: process.env.METAMASK_ACCOUNT, gas: 100000},
        (error, txHash) => {console.log(`donated from wallet1: ${txHash}`)});

    await wallet2Instance.methods.donate(donation).send({from: process.env.METAMASK_ACCOUNT, gas: 100000},
        (error, txHash) => {console.log(`donated from wallet2: ${txHash}`)});

    process.exit(0);
})();